%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Lachaise Assignment
% LaTeX Template
% Version 1.0 (26/6/2018)
%
% This template originates from:
% http://www.LaTeXTemplates.com
%
% Authors:
% Marion Lachaise & François Févotte
% Vel (vel@LaTeXTemplates.com)
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
% 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%----------------------------------------------------------------------------------------
%	PACKAGES AND OTHER DOCUMENT CONFIGURATIONS
%----------------------------------------------------------------------------------------

\documentclass{article}

\input{structure.tex} % Include the file specifying the document structure and custom commands

%----------------------------------------------------------------------------------------
%	ASSIGNMENT INFORMATION
%----------------------------------------------------------------------------------------

\title{Functionaal Analysis Stein: Chapter 1. Exercises.} % Title of the assignment

\author{Kelvin Hong\\ \texttt{kh.boon2@gmail.com}} % Author name and email address

\date{Xiamen University Malaysia, Asia Pacific University Malaysia --- \today} % University, school and/or department name(s) and a date

%----------------------------------------------------------------------------------------

\begin{document}

\maketitle % Print the title

\section{Problems}

\begin{enumerate}
    \item Consider $L^p=L^p(\mathbb R^d)$ with Lebesgue measure. Let $f_0(x)=\abs{x}^{-\alpha}$ if $\abs x<1$.
    $f_0(x)=0$ for $\abs x\geq 1$, also let $f_\infty(x)=\abs{x}^{-\alpha}$ if $\abs x\geq 1$,
    $f_\infty(x)=0$ when $\abs x<1$.

    Show that 
    \begin{enumerate}[(a)]
        \item $f_0\in L^p$ if and only if $p\alpha < d$.

        \begin{solution}
        Let $S_{d-1}$ be the surface area of the open unit ball $B_d=\{\abs x<1: x\in\mathbb R^d\}$ in $\mathbb R^d$, then if $f_0\in L^p$
        we can write
        $$\|f_0\|_{L_p}^p= \int_{B_d} \abs x^{-p\alpha} dx = S_{d-1} \int_0^1 \dfrac{1}{r^p\alpha}\cdot r^{d-1} dr=S_{d-1} \int_0^1 \dfrac1{r^{1-d+p\alpha}}dr.$$
        Since the integral converges, we must have $1-d+p\alpha<1$ so $p\alpha<d$. We saw that the converse is also true.
        \end{solution}

        \item $f_\infty\in L^p$ if and only if $d<p\alpha$.

        \begin{solution}
        Similar to the previous part, we have
        $$\|f_\infty\|_{L_p}^p= S_{d-1} \int_1^\infty \dfrac1{r^{1-d+p\alpha}}dr$$
        which is finite iff $d<p\alpha$.
        \end{solution}

        \item What happens if in the definitions of $f_0$ and $f_\infty$ we replace $\abs x^{-\alpha}$ by $\abs x^{-\alpha}/(\log(2/\abs x))$ for $\abs x<1$,
        and $\abs x^{-\alpha}/(\log(2\abs x))$ for $\abs x\geq 1$?

        \begin{solution}
            If the definition of $f_0$ changed to $$f_0(x) = \begin{cases}
                \abs x^{-\alpha} /\log(2/\abs x) & \text{if } \abs x<1,\\
                0 & \text{if } \abs x\geq 1,
            \end{cases}$$
            Then we want to show that $f_0\in L^p$ iff $p\alpha<d$, or $p\alpha=d$ with $p>1$, which is a little bit more nuanced than the previous part.
            When $p\alpha<d$, we see that $\abs f_0\leq \frac1{\log 2} \abs x^{-\alpha}$, so that $f_0\in L^p$ as it is absolutely bounded above by another function in $L^p$.

            When $p\alpha=d$, we have
            $$S_{d-1}^{-1}\|f_0\|_p^p=\int_0^1 \dfrac{dr}{r(\log(2/r))^p}.$$
            Using substitution $u=\log(2/r)$, the RHS becomes $\int_{\log 2}^\infty \dfrac{du}{u^p}$, which converges when $p>1$ and diverges when $p\leq 1$.

            When $p\alpha>d$, we want to prove $f_0\notin L^p$. We have
            \begin{align*}
                S_{d-1}^{-1} \int_{\mathbb R^d} |f_0|^p dx &= \int_0^1 \dfrac{r^{-p\alpha} r^{d-1}}{(\log (2/r))^p}dr\\
                &\geq \int_0^{1/2} \dfrac{dr}{r^{1+p\alpha -d} (\log (2/r))^p}\\
                &\geq \int_0^{1/2} \dfrac{dr}{r^{1+p\alpha-d}2^p (\log (1/r))^p}.
            \end{align*}
            The last step is because $2/r \leq 1/r^2$ whenever $0<r<1/2$. We now using $u=1/r$, RHS can be
            $$RHS \geq \int_2^\infty \dfrac{du}{2^p u^{1-p\alpha+d}(\log u)^p}.$$
            By assumption, $1-p\alpha+d<1$, we can now choose $\theta>0$ so that $1-p\alpha+d+\theta<1$, then choose $K>2$ big enough such that
            $(\log u)^p < u^\theta$ for all $u\geq K$, hence
            $$RHS \geq \int_K^\infty \dfrac{du}{2^p u^{1-p\alpha+d+\theta}} = +\infty,$$
            hence $f_0\notin L^p$.

            If the definition of $f_\infty$ changed to $$f_\infty(x) = \begin{cases}
                \abs x^{-\alpha} /\log(2\abs x) & \text{if } \abs x\geq1,\\
                0 & \text{if } \abs x< 1,
            \end{cases}$$
            then by a similar argument, we have $f_\infty\in L^p$ whenever $d<p\alpha$. When $p\alpha=d$, we can similarly prove that $f_\infty\in L^p$ iff $p>1$. Moreover,
            $f_\infty \notin L^p$ when $p\alpha<d$.
        \end{solution}
    \end{enumerate}
    \item Consider the spaces $L^p(\mathbb R^d)$, when $0<p<\infty$
    \begin{enumerate}[(a)]
        \item Show that if $\|f+g\|_{L^p}\leq \|f\|_{L^p} + \|g\|_{L^p}$ for all $f$ and $g$, then necessarily $p\geq 1$.
        
        \begin{solution}
            We only need to show there are $f,g\in L^p$ such that $\|f+g\|_{L^p}> \|f\|_{L^p} + \|g\|_{L^p}$ when $0<p<1$. Let $K_1=\{x\in \mathbb R^d: x_i\in (0,1) \forall 1\leq i\leq d\}$
            be a unit square in $\mathbb R^d$, and also $K_{-1}=\{x\in \mathbb R^d: x_i\in (-1,0) \forall 1\leq i\leq d\}$ be its mirror.

            We then have $\|f\|_{L^p}=\|g\|_{L^p}=1$, but then $\|f+g\|_{L^p}=2^{1/p} > 2 = \|f\|_{L^p}+\|g\|_{L^p}$.
        \end{solution}

        \item Consider $L^p(\mathbb R)$ where $0<p<1$. Show that there are no bounded linear functionals on this space.
        In other words, if $\ell$ is a linear functional $L^p(\mathbb R)\mapsto \mathbb C$ that satisfies
        $$\abs{\ell(f)} \leq M\ \|f\|_{L^p(\mathbb R)} \quad\text{ for all $f\in L^p(\mathbb R)$ and some $M>0$,}$$
        then $\ell=0$.

        \begin{solution}
            For each $x>0$, we let $\chi_x$ be the characteristic function of $[0,x]$ on $\mathbb R$, then extends it naturally to $x\leq 0$
            where it is the characteristic function of $[x, 0]$. Let $F(x)=\ell(\chi_x)$.

            Suppose $\ell$ is a bounded linear functional with the constant $M$ as stated in the question, then for any $x,y\in \mathbb R$
            we must have
            $$\abs{F(x)-F(y)} = \abs{\ell(\chi_x-\chi_y)} \leq M \|\chi_x-\chi_y\|_{L^p(\mathbb R)}=M\abs{x-y}^{1/p}.$$
            This means that $F$ is a continuous function, but then since 
            $$\abs{\dfrac{F(x)-F(y)}{x-y}} \leq M\abs{x-y}^{1/p-1},$$
            $F$ is then differentiable and has derivative $0$ everywhere, hence $F$ is a constant function, and must be zero too
            because $F(0)=\ell(\chi_0)=0$.
            This shows $\ell$ can only be zero.
        \end{solution}
    \end{enumerate}

    \item If $f\in L^p$  and $g\in L^q$, both not identically equal to zero, show that equality
    holds in H\"older's inequality if and only if there exist two non-zero constants $a,b\geq 0$
    such that $a\abs{f(x)}^p = b\abs{g(x)}^q$ for almost every $x$.

    \begin{solution}
        Since we have to prove $a\abs{f(x)}^p = b\abs{g(x)}^q$, we assume $p, q$ are both finite, that means if $\theta=1/p$, then
        $\theta\in(0,1)$. From the proof of H\"older's inequality, we also write $\hat f=f/\|f\|_p$ and $\hat g=g/\|g\|_q$, these
        are well-defined because  $f,g$ are not identically zero (we assume it means not equal to zero almost everywhere).

        Again from the proof of H\"older's inequality, we have an inequality $A^\theta B^{1-\theta}\leq \theta A + (1-\theta) B$
        when $A,B$ are non-negative numbers. Since $\theta\in(0,1)$, the inequality is strict iff $A\neq B$,
        thus by assumption we must have $A=B$, which means $\abs{\hat f(x)}^p = \abs{\hat g(x)}^q$. Since the equality
        $\|fg\|_1 = \|f\|_p \|g\|_q$ only holds when the above mentioned inequality holds for almost every $x$, we must have
        $\abs{\hat f(x)}^p = \abs{\hat g(x)}^q$ for almost every $x$.
        
        Unnormalize we have $\|g\|_q^q\abs{f(x)}^p = \|f\|_p^p\abs{g(x)}^q$, which proves the statement because $\|f\|_p$ and $\|g\|_q$
        are both positive.
    \end{solution}

    \item Suppose $X$ is a measure space and $0<p<1$
    \begin{enumerate}[(a)]
        \item Prove that $\|fg\|_{L^1} \geq  \|f\|_{L^p} \|g\|_{L^q}$. Note that $q$, the
        conjugate exponent of $p$, is negative.

        \begin{solution}
            If either $\|f\|_{L^p}=0$, $\|g\|_{L^q}=0$, or $fg\notin L^1$, then there is nothing to prove. Thus we may assume
            $fg\in L^1$ and that $\|f\|_{L^p}>0, \|g\|_{L^q}>0$, and that $\|g\|_{L^q}$ is finite, from here we note that it is easier to assume $g\neq 0$ a.e.

            By taking $p'=1/p  > 1$ and let $q'$ be the conjugate exponent of $p'$, we have
            \begin{align*}
                \int \abs{f}^p &= \int\abs{fg}^p \abs{g}^{-p}\\
                &\leq \left(\int \abs{fg}^{pp'}\right)^{1/p'} \left(\int \abs{g}^{-pq'}\right)^{-1/q'}\\
                &= \left(\int \abs{fg}\right)^p \left(\int \abs{g}^q\right)^{p-1}\\
                \therefore \left(\abs{fg}\right)^p &\geq \left(\abs{f}^p\right) \left( \int\abs{g}^q\right)^{1-p}\\
                \|fg\|_{L^1} &\geq \|f\|_{L^p} \|g\|_{L^q}.
            \end{align*}
        \end{solution}

        \item Suppose $f_1$ and $f_2$ are non-negative. Then $\|f_1+f_2\|_{L^p} \geq \|f_1\|_{L^p} + \|f_2\|_{L^p}$.
        
        \begin{solution}
            We have
            \begin{align*}
                \int \abs{f_1+f_2}^p &= \int f_1(f_1+f_2)^{p-1} + \int f_2(f_1+f_2)^{p-1}\\
                &\geq \|f_1\|_{L^p} \|(f_1+f_2)^{p-1}\|_{L^q} + \|f_2\|_{L^p} \|(f_1+f_2)^{p-1}\|_{L^q}\\
                &= (\|f_1\|_{L^p} + \|f_2\|_{L^p}) \|(f_1+f_2)\|_{L^p}^{p-1}
            \end{align*}
            which proves the statement.
        \end{solution}
        \item The function $d(f,g)=\|f-g\|_{L^p}^p$ for $f,g\in L^p$ defines a metric
        on $L^p(X)$.

        \begin{solution}
            The function $d$ obviously satisfies $d(f,g)=0$ iff $f=g$ a.e., and that it is symmetric.
            If $a,b$ are non-negative numbers, then we have $a^p+b^p\geq (a+b)^p$ for $0<p<1$. This means that for $f,g,h\in L^p$, we have

            $$d(f,h) = \|f-g+g-h\|_{L^p}^p \leq \|f-g\|_{L^p}^p + \|g-h\|_{L^p}^p = d(f,g)+d(g,h),$$
            hence $d$ defines a metric on $L^p(X)$. 
        \end{solution}
    \end{enumerate}

    \item Let $X$ be a measure space. Using the argument to prove the completeness of $L^p(X)$, show that if the sequence $\{f_n\}$ converges to $f$ in the $L^p$ norm, then
    a subsequence of $\{f_n\}$ converges to $f$ almost everywhere.

    \begin{solution}
        Let $\{f_n\}$ be a sequence in $L^p(X)$ that converges to $f$ in the $L^p$ norm. We can choose a subsequence $\{f_{n_k}\}$ such that
        $\|f_{n_{k+1}} - f_{n_k} \|_{L^p} < 2^{-k}$ for each $k\geq 1$.

        Now we define 
        \begin{align*}
            g(x) &= f_{n_1}(x) + \sum_{k=1}^\infty (f_{n_{k+1}}(x) - f_{n_k}(x))\\
            h(x) &= \abs{f_{n_1}(x)} + \sum_{k=1}^\infty \abs{f_{n_{k+1}}(x) - f_{n_k}(x)},
        \end{align*}
        following a similar argument when proving the completeness of $L^p(X)$, we see $f_{n_k}\to g$ a.e. on $X$.

        Now we want to show $\|g-f\|_{L^p}=0$, which could in turn proves that $g=f$ a.e. on $X$.

        Given $\varepsilon>0$, we choose $K_0$ such that $2^{-K_0}< \varepsilon$. Then for any $K>K_0$ we have
        $\|g-f_{n_K}\|_{L^p} \leq \sum_{k=K}^\infty \|f_{n_{k+1}}(x) - f_{n_k}(x)\|_{L^p}\leq 2^{-K_0}<\varepsilon$. By letting $K$ to also be big enough
        to satisfies $\|f-f_{n_K}\|_{L^p} < \varepsilon$, we have $\|g-f\|_{L^p} < 2\varepsilon$. Subsequently we have $f_{n_k}\to f$ a.e. on $X$. 
    \end{solution}

    \item Let $(X, \mathcal F, \mu)$ be a measure space. Show that,
    \begin{enumerate}
        \item The simple functions are dense in $L^\infty(X)$ if $\mu(X)<\infty$, and;
        
        \begin{solution}
            (Note: The definition of simple function is not completely clear in the context of this book, but it is reasonable to
            assume it means "finite sum of indication functions with finite support", else the problem statement assuming $\mu(X)<\infty$
            doesn't make sense)

            Let $f$ be any function in $L^\infty(X)$.
            WLOG we can assume $\abs f \leq M = \|f\|_{L^\infty}$ everywhere on $X$ (instead of almost everywhere).
            Given a positive integer $j$, choose any integer $\ell$ satisfying $-j\leq \ell\leq j$, we define
            $$E_{\ell, j} = \left\{x\in X: \dfrac{M\ell}j \leq f(x) < \dfrac{M(\ell+1)}{j}\right\}.$$
            There are $2j+1$ such sets, they are mutually disjoint and that $X=\bigcup_{\ell=-j}^j E_{\ell, j}$.
            We then let $$f_j(x) = \dfrac{M\ell}j \quad\text{ if } x\in E_{\ell, j},$$
            which is a simple function that is well-defined everywhere on $X$.

            We then see that $\|f_j-f\|_{L^\infty} \leq 1/j$, hence $\{f_j\}_{j=1}^\infty$ converges to $f$ in the $L^\infty$ norm.
        \end{solution}
        \item The simple functions are dense in $L^p(X)$ for $1\leq p<\infty$.

        \begin{solution}
            Let $f\in L^p(X)$, without loss of generality we assume $f$ is nonnegative, as a general $f$ can be decomposed
            into the difference of two non-negative functions in $L^p(X)$. We do not assume $f$ is bounded.

            For each positive integer $n$, we define for each $k=1, \dots, n2^n-1$ such that
            $$E_{k, n} = \left\{x\in X: \dfrac k{2^n}\leq f(x) < \dfrac{k+1}{2^n}\right\}$$
            Note that each $E_{k, n}$ is of finite measure. We now define
            $$f_n(x) = \begin{cases}
                \dfrac k{2^n} & \text{if } x\in E_{k, n},\\
                0 & \text{if } x\notin \bigcup_{k=1}^{n2^n-1} E_{k, n}.
            \end{cases}$$
            Note that $f_n(x)=0$ can happen when $f(x)>=n$ or $f(x) < 1/2^n$. Nevertheless, $f_n\nearrow f$ a.e. on $X$, hence
            $\abs{f_n(x)} \leq f(x)$ a.e. on $X$. By the Dominated Convergence Theorem, we have
            $\lim_{n\to\infty}\int_X \abs{f_n(x)-f(x)}^pdx = 0$, thus $\{f_n\}$ converges to $f$ in the $L^p$ norm.
        \end{solution}
    \end{enumerate}
\end{enumerate}


\end{document}
